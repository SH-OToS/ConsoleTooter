#!/bin/sh
mes="test" # toot空打ちの時投稿する文字列を定義
vis="public" # 公開範囲を指定
url="https://url" # URLを指定
token="token" # トークンを指定

if [ -t 0 ]; then
  if [ $# -ne 1 ]; then
    curl -F "status=$mes" -F "visibility=$vis" -sS "$url" --header "Authorization: Bearer $token" -o /dev/null -w '%{http_code}'
  else
    if [ $1 = "--help" ]; then
      echo "ConsoleTooter v0.0.1"
      echo "コンソールで作業中にちょっとTootしたくなったときに使えます"
      echo "Github: https://github.com/SH-OToS/ConsoleTooter"
      echo "現在の公開範囲: $vis"
      echo "\ntoot [内容]      [内容を投稿]"
      echo "toot             $mesを投稿"
      exit 0
    else
      curl -F "status=$1" -F "visibility=$vis" -sS "$url" --header "Authorization: Bearer $token" -o /dev/null -w '%{http_code}'
    fi
  fi
else
  curl -F "status=$(cat -)" -F "visibility=$vis" -sS "$url" --header "Authorization: Bearer $token" -o /dev/null -w '%{http_code}'
fi

exit 0
